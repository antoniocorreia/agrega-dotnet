@page "/"
@using Microsoft.AspNetCore.Authorization

@attribute [AllowAnonymous]




<section class="section">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="features-absolute blog-search">
                    <div class="row justify-content-center">
                        <div class="col-md-10">
                            <div class="text-center subcribe-form">
                                <form style="max-width: 800px;">
                                    <div class="mb-0">
                                        <input type="text" id="help" name="name" class="border shadow rounded-pill bg-white-color" required="" placeholder="Search">
                                        <button type="submit" class="btn btn-pills btn-primary">Search</button>
                                    </div>
                                </form>
                            </div>
                        </div><!--end col-->
                    </div><!--end row-->
                </div><!--end div-->
            </div><!--end col-->
        </div><!--end row-->
    </div><!--end container-->

    
    <div class="container">
        <div class="row align-items-center mb-4 pb-2">
            <div class="col-md-8">
                <div class="section-title text-center text-md-start">
                    <h4 class="mb-4">Recent Post</h4>
                    <p class="text-muted mb-0 para-desc">Check what's new in the .NET world.</p>
                </div>
            </div>

            <div class="col-md-4 mt-4 mt-sm-0">
                <div class="text-center text-md-end">
                    <a href="javascript:void(0)" class="btn btn-soft-primary">See More <i data-feather="arrow-right" class="fea icon-sm"></i></a>
                </div>
            </div>
        </div>

        <div class="row">
           @if (Loading)
           {
               <p>Building your news feed...</p>
           }

            @foreach (var post in posts)
            {
                <div class="col-lg-4 col-md-6 mt-4 pt-2">
                    <div class="card blog blog-primary rounded border-0 shadow overflow-hidden">
                       @* <div class="position-relative">
                            <img src="@post.Blog.ImageUrl" class="card-img-top" alt="...">
                            <div class="overlay rounded-top"></div>
                        </div>*@
                        <div class="card-header">
                            <div class="row">
                                <div class="col-2"><img src="@post.Blog.ImageUrl" class="rounded" width="36" alt="..."></div>
                                <div class="col">
                                    <b>@post.Blog.Name</b>
                                    <aside style="font-size:12px;color:gray;">@post.PostDate.Value.ToString("MM/dd/yyyy")</aside>
                                </div>
                            </div>
                            @*<img src="@post.Blog.ImageUrl" class="img-thumb" height="48" alt="...">*@
                            
                        </div>
                        <div class="card-body content">


                            <h5><a href="@post.Url" target="_blank" class="card-title title text-dark">@post.Subject</a></h5>
                            <div class="post-meta d-flex justify-content-between mt-3">
                                @*<ul class="list-unstyled mb-0">
                                    <li class="list-inline-item me-2 mb-0"><a href="javascript:void(0)" class="text-muted like"><i class="uil uil-heart me-1"></i>33</a></li>
                                    <li class="list-inline-item"><a href="javascript:void(0)" class="text-muted comments"><i class="uil uil-comment me-1"></i>08</a></li>
                                </ul>*@
                                <a href="@post.Url" target="_blank" class="text-muted readmore">Read More <i class="uil uil-angle-right-b align-middle"></i></a>
                            </div>
                        </div>
                       @* <div class="author">
                            <small class="user d-block"><i class="uil uil-user"></i> @(post.Authors.FirstOrDefault() ?? post.Blog.Name)</small>
                            <small class="date"><i class="uil uil-calendar-alt"></i> </small>
                        </div>*@
                    </div>
                </div>

            }
           
        </div><!--end row-->
    </div><!--end container-->
    <!-- Cta start -->
   @* <div class="container-fluid mt-100 mt-60">
        <div class="rounded-md shadow-md py-5 position-relative" style="background: url('/_content/AgregaDotNet.Razor.UI/images/3.jpg') center center;">
            <div class="bg-overlay rounded-md"></div>
            <div class="container py-5">
                <div class="row justify-content-center">
                    <div class="col-12">
                        <div class="section-title text-center">
                            <h2 class="fw-bold text-white title-dark mb-4 pb-2">People are podcasting <br> all over the world</h2>
                            <a href="javascript:void(0)" class="btn btn-primary">Read More <i data-feather="arrow-right" class="fea icon-sm"></i></a>
                        </div>
                    </div><!--end col-->
                </div><!--end row-->
            </div><!--end container-->
        </div><!--end slide-->
    </div><!--end container-->*@
    

    <div class="container mt-100 mt-60">
        <div class="row align-items-center mb-4 pb-2">
            <div class="col-md-8">
                <div class="section-title text-center text-md-start">
                    <h4 class="mb-4">And videos</h4>
                    <p class="text-muted mb-0 para-desc">Some of the most recent Youtube videos of our <a href="/creators" target="_blank" class="text-primary fw-bold">creators</a> list.</p>
                </div>
            </div><!--end col-->
        </div><!--end row-->

        <div class="row">
            @if(LoadingVideos){
                <p>Building your videos feed...</p>
            }
            @foreach (var video in videos)
            {
                <div class="col-lg-4 col-md-6 mt-4 pt-2">
                    <div class="card blog blog-primary rounded border-0 shadow overflow-hidden">
                        <div class="position-relative">
                            <img src="@video.ImgUrl" class="card-img-top" alt="...">
                            <div class="overlay rounded-top"></div>
                        </div>
                        <div class="card-body content">
                            <h5><a href="@video.Url" class="card-title title text-dark">@video.Subject</a></h5>
                            <div class="post-meta d-flex justify-content-between mt-3">
                               
                                <a href="@video.Url" target="_blank" class="text-muted readmore">Watch Now <i class="uil uil-angle-right-b align-middle"></i></a>
                            </div>
                        </div>
                        <div class="author">
                            <small class="user d-block"><i class="uil uil-user"></i> @video.Blog.Name</small>
                            <small class="date"><i class="uil uil-calendar-alt"></i> @video.PostDate.Value.ToString("MM/dd/yyyy")</small>
                        </div>
                    </div>
                </div>
            }
           

           

            <div class="col-12 mt-4 pt-2">
                <div class="text-center">
                    <a href="javascript:void(0)" class="btn btn-primary">See More <i data-feather="arrow-right" class="fea icon-sm"></i></a>
                </div>
            </div>
        </div>
    </div>
</section>



@code {
    ICollection<Post> posts = new List<Post>();
    ICollection<Post> videos = new List<Post>();
    public bool Loading { get; set; } = true;
    public bool LoadingVideos { get; set; } = true;

    protected async override Task OnInitializedAsync()
    {
        posts = await PublicApi().GetBlogPostsAsync();
        Loading = false;
        StateHasChanged();
        videos = await PublicApi().GetYoutubeVideosAsync();
        LoadingVideos = false;
        StateHasChanged();
    }

}
